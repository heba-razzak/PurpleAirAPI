---
title: "Getting Started with PurpleAirAPI"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started with PurpleAirAPI}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
api_key <- Sys.getenv("PURPLEAIR_API_KEY")
```

```{r setup}
library(PurpleAirAPI)
```

## Introduction

The PurpleAirAPI package provides tools for accessing air quality data from PurpleAir sensors. This vignette demonstrates how to:

1. Get sensor metadata
2. Download historical data

## Getting Sensor Information

First, let's get information about available sensors:

```{r, eval=FALSE}
# Replace with your API key
api_key <- "YOUR_API_KEY"
```

```{r, eval=TRUE}
# Get sensor locations
sensors <- getPurpleairSensors(
  apiReadKey = api_key,
  fields = c("latitude", "longitude", "date_created", "last_seen", "location_type")
)

head(sensors)
```

## Downloading Historical Data

Once you have identified sensors of interest, you can download their historical data:

```{r, eval=TRUE}
# Download one week of hourly data for 3 sensors
history <- getSensorHistory(
  sensorIndex = sensors$sensor_index[1:3],
  apiReadKey = api_key,
  startDate = "2024-01-01",
  endDate = "2024-01-07",
  average = 60,  # hourly averages
  fields = c("pm2.5_alt", "pm2.5_alt_a", "pm2.5_alt_b", "temperature", "humidity")
)

head(history)
```
